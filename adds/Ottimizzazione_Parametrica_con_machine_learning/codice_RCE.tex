1function WorkloadCandidateGeneration(workload W1math)
    P1math 1leftarrow {}
    1for query instance q1math 1in W1math 1do
        P1math 1leftarrow P1math 1cup RowCountEvolution(q1math)
    1return P1math

1function 1RowCountEvolution(query instance q1math)
    p0 1leftarrow base plan for q1math
    C0 = {(p0, {}, {(s1math 1rightarrow 0 2forall sub-plans s1math})}
    1for generations g1math = 1, 2, ..., G1math 1do
        Sample up to S1math base plans Bg uniformly from C1g
        Cg 1leftarrow {}
        1for (base plan p1math, row count map r1math) 1in Bg 1do
            1for i1math = 1, 2, ..., N1math 1do
                r1prime 1leftarrow SamplePerturbations(p1math, r1math)
                p1prime 1leftarrow GetOptimizerPlan(r1prime)
                1if p1prime != p1math 1then
                    Cg.add((p1prime, r1prime))
    1return C0 1cup C1 1cup ... 1cup CG

1function 1SamplePerturbations(plan p1math, row count map r1math)
    1for sub-plan s1math 1in p1math 1do
        w 1leftarrow p1math.getEstimatedCardinality(s1math)
        e1l 1leftarrow -min(1logb(w1math),m1math)
        e1u 1leftarrow e1l + 2m1math
        Sample f1math uniformly from [be1l, ..., be1u]
        r1math[s1math] 1leftarrow w1math 1cdot f1math
    1return r1math